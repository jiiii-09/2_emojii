let cnv;
let mic, fft;
let centerY;
let triggerActive = false;
let triggerTime = 0;
let waveformVals;
let mySVGPoints = [];

let svgPaths = [
//1ÏÇ¨Îûë
  "M 0 112.06 H 92.78 C 86.56 107.27 56.4 83.43 53.91 69.92 C 52.53 62.41 54.2 55.13 58.5 49.97 C 62.49 45.18 68.26 42.65 75.2 42.65 C 91.15 42.65 95.99 55.47 97.25 60.3 C 98.8 55.5 104.26 42.65 118.45 42.65 C 125.51 42.65 131.53 45.44 135.39 50.49 C 139.41 55.76 140.68 63.03 138.79 69.95 C 135.09 83.51 107.22 107.3 101.52 112.06 H 200",  

  // "2Î®π"
  "M 0 112.06 H 87.12 V 65.56 C 87.12 65.56 76.3 61.16 76.3 47.82 C 76.3 39.45 79.6 29.11 90 29.11 C 99.59 29.11 103.45 38.11 103.45 46.33 C 103.45 59.15 93.6 65.81 93.6 65.81 V 112.06 H 109.08 C 109.08 112.06 109.56 29.09 113.69 29.09 C 117.3 29.09 114.64 112.06 114.64 112.06 H 117.94 C 117.94 112.06 118.56 29.09 120.71 29.09 C 124.42 29.09 124.68 112.06 124.68 112.06 H 199.98",
  
  //3
  "M 0 112.06 H 99.51 C 88.85 111.11 54.09 104.75 62.4 73.07 C 76.71 75.09 77.39 75.25 86.3 75.25 C 67.96 76.57 65.34 44.02 85.34 44.63 C 97 44.98 98.27 64.92 90.8 63.88 C 85.46 63.13 85.09 51.7 91.48 51.7 C 99.96 51.7 95.27 73.91 88.43 75.26 C 93.03 75.52 100.28 75.12 110.5 75.12 C 95.28 73.91 94.56 51.68 103.39 51.68 C 111.31 51.68 110.1 65.51 103.39 64.8 C 93.13 63.71 97.67 40.02 114.16 44.63 C 126.58 48.11 125.67 73.39 110.51 75.12 C 117.59 75.12 127.26 73.91 136.02 72.7 C 146.52 106.48 109.51 112.06 109.51 112.06 H 200.01",
  
  //4
  "M 0 112.06 H 99.28 C 88.62 111.11 53.86 104.75 62.17 73.07 C 76.48 75.09 77.16 75.25 86.07 75.25 C 67.73 76.57 65.11 44.02 85.11 44.63 C 96.77 44.98 98.04 64.92 90.57 63.88 C 85.23 63.13 84.86 51.7 91.25 51.7 C 99.73 51.7 95.04 73.91 88.2 75.26 C 92.8 75.52 100.05 75.12 110.27 75.12 C 100.92 74.37 96.95 65.44 98.29 60.14 C 99.5 55.34 104 54.42 106.59 54.52 C 109.44 54.63 112.03 55.96 113.84 58.71 C 109.5 55.37 101.85 54.59 98.29 60.14 C 98.25 53.43 101.17 41.06 113.92 44.63 C 126.34 48.11 125.43 73.39 110.27 75.12 C 117.35 75.12 126.63 73.91 135.43 72.69 C 144.1 105.25 109.27 112.07 109.27 112.07 H 200",
  
   //"5Î©ã,Î∞ù"
  "M 0 112.06 H 100.86 C 100.86 112.06 100.85 87.83 70.4 82.38 C 70.4 82.38 92.12 75.53 94.39 46.86 C 94.39 46.86 99.1 62.77 110.96 68.54 C 110.96 68.54 113.76 55.25 102.24 49.83 C 102.24 49.83 109.86 46.36 112.74 31.28 C 112.74 31.28 114.86 48.05 123.33 49.83 C 123.33 49.83 115.96 50 112.58 69.48 C 112.58 69.48 113.78 72.51 122.85 73.36 C 122.85 73.36 99.96 93.5 103.24 112.06 H 200",
  
  //6"Ìôî
  "M 0 112.02 H 85.21 C 85.21 112.02 60.6 111.45 60.43 89.7 C 60.28 70.34 72.72 73.01 86.45 51.44 C 90.35 45.32 73.51 81.82 80.09 79.62 C 84.84 78.03 97.18 52.85 92.65 34.71 C 88.12 16.57 106.36 55.11 108.49 64.54 C 110.18 72.03 110 52.53 110 52.53 C 110 52.53 143.29 91.14 111.5 110.47 C 111.5 110.47 113.4 75.37 98.88 63.11 C 98.88 63.11 100.29 69.4 93.79 77.62 C 88.56 84.23 83.48 85.1 80.93 92.51 C 73.59 113.9 114.58 112.03 114.58 112.03 H 201.9",
  
  //"7Ï¢ã"
  "M 0 111.95 H 76.54 C 76.54 111.95 70.12 84.28 76.95 66.53 C 80.63 56.98 84.95 54.13 85.92 48.72 C 86.88 43.38 85.79 34.09 92.27 33.77 C 98.64 33.45 103.23 42.9 103.74 48.14 C 104.53 56.29 99.85 64.86 99.85 64.86 C 99.85 64.86 125.4 61.81 125.78 72.07 C 125.91 75.5 123.41 77.25 123.41 77.25 C 123.41 77.25 127.74 79.06 127.72 83.12 C 127.7 87.79 123.74 88.96 123.74 88.96 C 123.74 88.96 127.23 90.81 127.23 94.76 C 127.23 99.02 122.05 100.11 122.05 100.11 C 122.05 100.11 126.07 101.92 126.05 105.33 C 126.02 111.15 119.5 112 119.5 112 H 199.99",
  
  //"8ÌñâÏö¥"
  "M 0 111.93 L 103.83 111.95 C 103.83 111.95 105.62 92.12 100 79.04 C 100 79.04 96.9 111.84 78.68 101.51 C 73.47 98.55 75.13 92.04 75.13 92.04 C 75.13 92.04 68.74 93.7 66.41 88.44 C 60.2 74.41 91.22 67.37 91.22 67.37 C 91.22 67.37 57.54 77.08 63.34 52.15 C 65.35 43.5 76.47 41.79 76.47 41.79 C 76.47 41.79 76.9 36.97 81.69 33.74 C 89.74 28.32 100.06 33.85 98.96 59.38 C 98.96 59.38 96.41 28.44 115.23 31.58 C 124.96 33.2 123.07 40.26 123.07 40.26 C 123.07 40.26 132.21 40.82 134.57 46.86 C 139.42 59.26 125.7 64.46 111.67 65.45 C 111.67 65.45 135.82 62.04 138.71 73.43 C 141.23 83.35 132.14 84.4 132.14 84.4 C 132.14 84.4 134.27 90.87 129.34 95.1 C 120.53 102.68 105.82 85.74 102.56 75.48 L 113.13 112 L 199.99 111.98",
  
  //9Ïä¨Ìîà
  "M 0 112 L 93.59 112.02 C 93.59 112.02 83.12 136.74 94.36 136.74 C 105.6 136.74 95.47 112 95.47 112 C 95.47 112 136.44 178.76 105.3 178.76 C 74.16 178.76 112.94 112 112.94 112 H 199.99",
  
  //10Î¨∏Ï†ú
  "M 0 112 H 76.27 C 76.27 112 82.85 100.92 87.37 102.26 C 91.01 103.33 99.79 112.27 97.36 115.18 C 95.73 117.14 89.2 114.92 87.38 113.14 C 84.3 110.13 81.03 99.87 83.52 96.36 C 86.46 92.22 99.92 90.71 103.71 94.09 C 106.71 96.77 105.36 106.52 103.71 110.19 C 100.82 116.64 80.21 122.37 82.62 129.02 C 84.68 134.73 108.25 129.93 106.89 129.02 C 105.53 128.11 86.14 124.33 85.11 118.36 C 84.27 113.46 99.85 103.62 98.72 103.84 C 97.59 104.06 114.76 94.22 117.77 98.17 C 120.78 102.12 106.25 110.31 107.34 115.18 C 108.55 120.61 128.13 122.31 125.94 127.43 C 124.25 131.39 113.29 122.38 109.16 123.57 C 103.38 125.23 97.33 143.64 92.15 140.58 C 87.73 137.97 93.87 124.13 97.82 120.85 C 102.81 116.7 121.97 124.62 123.68 118.35 C 125.02 113.41 112.2 106.91 107.12 106.33 C 97.7 105.25 84.01 127.85 76.57 121.97 C 69.31 116.23 84.4 111.86 91.47 105.88 C 98.57 99.87 104.49 87.19 111.2 93.63 C 116.16 98.39 116.64 112.01 116.64 112.01 H 200",
  
  //11ÏÉùÍ∞Å
  "M 0 112.06 L 70.68 112.11 C 68.58 111.16 67.77 109.32 67.77 106.96 C 67.77 104.15 70.05 101.87 72.86 101.87 C 73.57 101.87 74.24 102.02 74.86 102.28 C 74.73 101.73 74.65 101.17 74.65 100.58 C 74.65 96.68 77.81 93.51 81.72 93.51 C 81.87 93.51 82.02 93.52 82.17 93.53 C 79.49 92.28 77.27 90.2 75.84 87.62 C 74.79 87.87 73.7 88.02 72.57 88.02 C 64.86 88.02 58.61 81.77 58.61 74.06 C 58.61 70.15 60.22 66.62 62.82 64.08 C 61.78 62.13 61.18 59.9 61.18 57.53 C 61.18 49.82 67.43 43.57 75.14 43.57 C 77.41 43.57 79.55 44.12 81.45 45.09 C 83.6 40.15 88.52 36.7 94.25 36.7 C 98.78 36.7 102.8 38.87 105.35 42.22 C 107.56 40.75 110.22 39.88 113.08 39.88 C 120.79 39.88 127.04 46.13 127.04 53.84 C 127.04 54.28 127.01 54.71 126.97 55.13 C 131.76 57.34 135.09 62.17 135.09 67.8 C 135.09 74.85 129.85 80.67 123.06 81.61 C 122.19 88.48 116.34 93.81 109.22 93.81 C 105.22 93.81 101.63 92.12 99.09 89.43 C 96.54 92.72 92.56 94.84 88.07 94.84 C 87.18 94.84 86.32 94.75 85.48 94.59 C 87.47 95.84 88.79 98.05 88.79 100.57 C 88.79 104.47 85.63 107.64 81.72 107.64 C 80.32 107.64 79.02 107.23 77.92 106.53 C 77.93 106.68 77.94 106.82 77.96 106.96 C 78.27 109.21 77.13 111.39 74.88 112.16 L 200 112.06",
  
  //12ÏïàÎÖï
  "M 0 112.06 H 96.09 C 96.09 112.06 48.65 80.46 57.31 73.56 C 61.73 70.04 74.57 86.71 79.75 82.24 C 84.02 78.55 55.52 56.63 64.83 50.61 C 71.54 46.27 86.61 75.77 89.3 72.52 C 91.61 69.73 70.35 40.02 79.93 37.29 C 88.91 34.73 96.37 68.85 102.58 67.49 C 107.94 66.31 98.12 39.31 106.65 38.68 C 116.5 37.95 112.99 77.91 121.17 79.28 C 127.68 80.37 128.68 65.56 137.1 67.03 C 150.6 69.39 123.69 112.06 123.69 112.06 H 200",
  
  //Ïßë13
  "M 200 112.06 L 130.29 112.06 L 130.29 72.73 L 143.24 72.73 L 143.24 70.8 L 99.73 45.49 L 56.21 70.8 L 56.21 72.73 L 69.59 72.73 L 69.59 112.06 L 0 112.06",
  
  //14ÌèâÌôî
  "M 200 112.06 H 146.14 C 146.14 112.06 125.76 98.81 120.16 89.6 C 114.56 80.39 113.89 80.5 113.89 80.5 C 113.89 80.5 126.66 74.67 130.41 67.41 C 134.16 60.15 133.6 25 131.83 29.08 C 126.35 41.69 92.32 65.13 92.32 65.13 C 92.32 65.13 90.79 53.62 80.37 53.92 C 75.92 54.05 70.2 60 70.2 60 L 67.54 54.59 C 67.54 54.59 70.41 52.81 70.86 47.61 C 71.31 42.41 68.69 37.43 68.69 37.43 C 68.69 37.43 63.38 42.19 62.75 46.42 C 62.08 50.86 63.8 52.96 63.8 52.96 C 63.8 52.96 61.95 51.31 58.81 50.86 C 54.07 50.17 48.37 53.68 48.37 53.68 C 48.37 53.68 51.56 60.18 57.07 60.3 C 63.17 60.44 66.19 56.81 66.19 56.81 L 68.94 61.01 C 67.02 63.38 65.91 65.43 65.91 65.43 C 65.91 65.43 67.72 64.6 70.06 64.46 C 70.06 64.46 71.69 68.52 72.2 71.28 C 72.71 74.04 71.64 76.74 71.64 76.74 L 75.92 77.05 C 75.92 77.05 75.83 72.32 75.05 69.92 C 74.27 67.52 72.16 64.56 72.16 64.56 C 74.04 64.85 76 65.77 77.52 67.95 C 80.86 72.75 80.54 82.19 86.62 87.71 C 92.7 93.23 111.21 90.62 117.04 94.27 C 122.87 97.92 126.64 112.05 126.64 112.05 H 0.05",
  
  //15ÌèâÎì±
  "M 0 112.06 H 70.66 C 70.66 112.06 87.54 112.44 91.68 108 C 93.46 106.09 94.4 102.91 95.16 99.4 C 95.92 95.89 98.33 94.64 98.33 94.64 V 51.63 C 98.33 51.63 96.62 51.35 96.09 50.14 C 96.09 50.14 95.62 46.41 95.62 46.41 C 95.62 46.41 87.14 46.61 81.22 47.52 C 74.2 48.6 65.44 51.54 65.44 51.54 L 85.64 95.29 C 85.64 95.29 79.2 100.96 64.26 100.96 C 64.26 100.96 43.29 95.29 43.29 95.29 L 62.88 50.88 C 62.88 50.88 73.93 45.9 81.8 44.28 C 87.5 43.11 95.81 42.3 95.81 42.3 C 95.81 42.3 95.81 40.18 97.11 38.11 C 98.01 36.69 99.82 35.77 99.82 35.77 C 99.82 35.77 101.84 36.69 102.73 38.11 C 104.04 40.18 104.03 42.3 104.03 42.3 C 104.03 42.3 112.34 43.11 118.04 44.28 C 125.92 45.9 136.96 50.88 136.96 50.88 L 156.55 95.29 C 156.55 95.29 150.53 100.96 135.58 100.96 C 120.63 100.96 114.2 95.29 114.2 95.29 L 134.4 51.54 C 134.4 51.54 125.65 48.6 118.62 47.52 C 112.7 46.61 104.22 46.41 104.22 46.41 C 104.22 46.41 104.28 48.93 103.75 50.14 C 103.22 51.35 101.51 51.63 101.51 51.63 V 94.64 C 101.51 94.64 103.92 95.89 104.68 99.4 C 105.44 102.91 106.31 106.02 108.09 107.93 C 112.23 112.37 129.34 112.07 129.34 112.07 H 200",
  
  //16Îàà
  "M 0 112 C 0 112 62.91 112 68.14 112 C 73.38 112 78.51 106.91 78.51 100.39 C 78.51 93.88 74.38 89.1 68.14 89.1 C 61.9 89.1 56.84 94.39 56.84 100.39 C 56.84 106.38 61.66 112 68.14 112 C 74.62 112 94.77 107.84 94.9 104.43 C 95 102 82.06 88.37 67.66 88.37 C 57.66 88.37 37.93 97.14 37.85 102.25 C 37.75 108.43 68.13 112.01 68.13 112.01 H 131.84 C 131.84 112.01 162.21 108.43 162.12 102.25 C 162.04 97.15 142.32 88.37 132.31 88.37 C 117.31 88.37 104.98 102 105.07 104.43 C 105.21 107.85 125.35 112 131.83 112 C 131.83 112 143.13 106.39 143.13 100.39 C 143.13 94.39 138.07 89.1 131.83 89.1 C 125.59 89.1 121.46 93.88 121.46 100.39 C 121.46 106.39 126.59 112 131.83 112 H 199.97",
  
  //17ÎÇòÏÅò
  "M 200 112.04 H 125.46 C 125.46 112.04 131.88 139.71 125.05 157.46 C 121.37 167.01 117.05 169.86 116.08 175.27 C 115.12 180.61 116.21 189.9 109.73 190.22 C 103.25 190.54 98.77 181.09 98.26 175.85 C 97.47 167.7 102.15 159.13 102.15 159.13 C 102.15 159.13 76.6 162.18 76.22 151.92 C 76.09 148.49 78.59 146.74 78.59 146.74 C 78.59 146.74 74.26 144.93 74.28 140.87 C 74.3 136.2 78.26 135.03 78.26 135.03 C 78.26 135.03 74.77 133.18 74.77 129.23 C 74.77 124.97 79.95 123.88 79.95 123.88 C 79.95 123.88 75.93 122.07 75.95 118.66 C 75.98 112.84 82.5 111.99 82.5 111.99 H 0",
  
  //18Í∏àÏßÄ
  "M 200 111.98 L 73.39 112 L 99.01 84.21 L 126.8 112 L 134.21 104.58 L 106.42 76.79 L 134.21 49 L 126.8 41.59 L 99.01 69.38 L 71.22 41.59 L 63.81 49 L 91.6 76.79 L 63.81 104.58 L 71.22 112 L 0 111.94",
  
  //19Ìûò,Ïö¥Îèô
  "M 0 112.02 H 74.07 L 75.07 104.19 C 75.07 104.19 35.05 92.84 35.05 79.17 C 35.05 65.5 43.95 44.11 51.38 42.22 C 59.26 40.21 61.51 45.51 61.51 50.08 C 61.51 54.65 54.34 53.33 53.5 55.52 C 50.76 62.69 53.45 74.8 53.45 74.8 C 53.45 74.8 59.99 73.6 63.93 75.93 C 67.87 78.26 68.61 81 68.61 81 C 68.61 81 74.21 75.63 80.76 75.1 C 87.09 74.59 91.55 75.63 91.55 75.63 C 91.55 75.63 82.9 72.61 83.1 61.94 C 83.3 51.27 88.95 43.65 100 43.65 C 111.05 43.65 116.71 51.08 116.9 61.76 C 117.1 72.43 108.45 75.45 108.45 75.45 C 108.45 75.45 112.91 74.41 119.24 74.92 C 125.57 75.43 131.39 80.82 131.39 80.82 C 131.39 80.82 132.13 78.08 136.07 75.75 C 140.01 73.42 146.55 74.62 146.55 74.62 C 146.55 74.62 149.24 62.51 146.5 55.34 C 145.66 53.15 138.49 54.47 138.49 49.9 C 138.49 45.33 140.74 40.03 148.62 42.04 C 156.05 43.93 164.95 65.33 164.95 78.99 C 164.95 92.65 124.93 104.01 124.93 104.01 L 125.93 111.84 H 200",
  
  //20Îèà
  "M -1.77 112 H 50.96 V 52.06 C 50.96 52.06 54.23 45.79 69.76 45.79 C 85.29 45.79 116.29 54.92 129.74 54.92 C 143.19 54.92 157.9 50.85 157.9 50.85 V 100.58 C 157.9 100.58 151.83 97.78 149.56 100.31 C 147.66 102.43 147.94 105.11 147.94 105.11 C 147.94 105.11 137.13 105.19 128.74 104.96 C 110.1 104.45 87.23 97.7 88.34 78.79 C 88.99 67.68 100.11 61.92 109.06 63.52 C 117.86 65.09 125.36 73.2 122.8 84.26 C 119.58 98.16 102.12 102.11 90.31 99.16 C 76.47 95.7 64.89 98.61 64.89 98.61 C 64.89 98.61 65.6 93.99 63.29 91.54 C 60.98 89.09 56.22 90.55 56.22 90.55 V 62.08 C 56.22 62.08 60.29 62.26 62.35 58.88 C 64.54 55.3 63.02 51.68 63.02 51.68 C 63.02 51.68 64.8 50.52 75.42 50.48 C 86.04 50.44 119.81 59.3 135.54 59.3 C 143.48 59.3 146.74 57.63 146.74 57.63 C 146.74 57.63 146.46 61.2 148.23 62.7 C 150 64.2 152.72 62.7 152.72 62.7 V 108.69 C 152.72 108.69 145.03 109.95 132.13 109.76 C 111.92 109.48 82.73 103.01 73.33 103.49 C 58.12 104.26 54.65 112 54.65 112 H 200.01",
  
  //21ÎèÖÏÑú,Ï±Ö,ÏùΩ
  "M 200 111.95 H 145.2 C 145.2 111.95 139.56 106.22 123.67 106.22 C 107.78 106.22 99.81 112.01 99.81 112.01 C 99.81 112.01 90.39 106.48 76.57 106.48 C 62.75 106.48 55.88 108.99 55.88 108.99 C 55.88 108.99 67.03 102.22 78.26 102.22 C 89.49 102.22 99.8 107.82 99.8 107.82 C 99.8 107.82 111.43 102.29 123.2 102.29 C 139.37 102.29 145.18 108.15 145.18 108.15 V 58.33 C 145.18 58.33 136.2 51.89 121.36 51.89 C 106.52 51.89 98.35 57.75 98.35 57.75 C 98.35 57.75 89.14 51.89 75.56 51.89 C 61.98 51.89 52.89 57.55 52.89 57.55 V 111.94 H 0",
  
  //22ÌïôÍµêÌïôÏÉùÌôçÎåÄÌôçÏùµ
  "M 0 112.01 H 51.17 V 78.86 L 56.17 68.72 H 76.19 L 76.46 57.88 L 98.93 44.08 V 29.4 C 98.93 29.4 100.39 28.31 103.43 29.4 C 106.47 30.49 108.02 31.63 110.18 32.54 C 112.34 33.45 114.44 32.65 114.44 32.65 V 41.89 C 114.44 41.89 112.42 42.93 110.79 42.39 C 109.16 41.85 107.12 39.94 104.56 39.01 C 102 38.08 99.78 39.01 99.78 39.01 L 99.9 44.09 L 122.19 57.89 L 122.65 68.73 H 142.67 C 142.67 68.73 147.67 78.87 147.67 78.87 V 112.02 H 88.22 C 88.22 112.02 87.4 98.57 88.22 90.99 C 88.61 87.41 90.27 79.76 99.17 79.76 C 108.07 79.76 109.73 87.41 110.12 90.99 C 110.94 98.57 110.12 112 110.12 112 H 200.01",
  
  //23ÎÇ†Ïßú,Ïñ∏Ï†ú,Îã¨Î†•
  "M 0 112 H 58.17 V 46.74 H 78.75 C 78.75 46.74 85.91 45.46 85.91 42.15 C 85.91 42.15 82.86 38.54 81.4 38.46 C 79.85 38.37 76.41 38.33 76.41 42.15 C 76.41 42.15 85.18 46.74 85.18 46.74 H 100.14 C 100.14 46.74 106.45 45.82 106.45 42.15 C 106.45 42.15 103.34 38.43 101.88 38.46 C 100.42 38.49 97.39 38.66 97.39 42.15 C 97.39 42.15 103.75 46.74 103.75 46.74 H 118.53 C 118.53 46.74 126.53 45.75 126.53 42.15 C 126.53 42.15 123.2 38.48 121.67 38.46 C 120.14 38.44 117.13 38.42 117.13 42.15 C 117.13 42.15 123.95 46.74 123.95 46.74 H 139.71 V 111.99 H 61.67 V 59.7 H 136.07 V 111.99 H 199.99",
  
  //24Î∞§,Îã¨
  "M 200 112 L 109.57 111.5 C 111.9 111.09 114.21 110.35 116.47 109.57 C 132.79 103.94 138.71 83.63 138.71 83.63 C 138.71 83.63 104.86 93.38 91.28 76.63 C 76.57 58.49 91.36 34.32 91.36 34.32 C 91.36 34.32 75.73 36.68 67.44 46.59 C 53.25 63.55 56.95 82.6 66.87 95.61 C 74.08 105.08 85.45 109.78 95.11 111.5 L 0.02 112",
  
  //25Ìï¥ÎÇÆÌôúÍ∏∞ÏïÑÏπ®ÌñáÎπõ
  "M 0 112.09 L 57.15 112.14 H 98.53 L 92.11 98.99 C 89.98 98.36 87.95 97.48 86.06 96.38 L 70.14 101.38 L 75.59 85.62 C 74.55 83.71 73.73 81.66 73.16 79.5 L 58.37 71.78 L 73.37 64.49 C 74 62.36 74.88 60.33 75.98 58.44 L 70.98 42.52 L 86.74 47.97 C 88.65 46.93 90.7 46.11 92.86 45.54 L 100.58 30.75 L 107.87 45.75 C 110 46.38 112.03 47.26 113.92 48.36 L 129.84 43.36 L 124.39 59.12 C 125.43 61.03 126.25 63.08 126.82 65.24 L 141.61 72.96 L 126.61 80.25 C 125.98 82.38 125.1 84.41 124 86.3 L 129 102.22 L 113.24 96.77 C 111.33 97.81 109.28 98.63 107.12 99.2 L 100.35 112.13 H 144.68 L 199.99 112.08",
  
  //26ÏÇ¨ÎûåÎÇ®ÏûêÏó¨Ïûê
  "M 0 112 L 60.89 112.05 C 60.89 90.97 71.32 73.01 85.94 66.13 C 82.3 62.65 80.03 57.74 80.03 52.31 C 80.03 41.74 88.6 33.17 99.17 33.17 C 109.74 33.17 118.31 41.74 118.31 52.31 C 118.31 57.75 116.04 62.65 112.4 66.13 C 127.02 73.01 137.45 90.98 137.45 112.05 L 200.01 112",
  
  //27ÏòÅÌôîÏòÅÏÉÅÏòÅÌôîÍ¥ÄÌåùÏΩò
  "M 0 112.04 L 64.42 112.04 L 64.42 48.53 L 132.93 27.07 L 135.53 34.13 L 125 37.39 L 126.83 31.67 L 120.62 33.59 L 118.21 39.49 L 110.12 41.99 L 112.83 36.03 L 105.56 38.28 L 102.66 43.96 L 95.17 46.62 L 98.47 40.63 L 91.37 42.82 L 88.13 48.27 L 80.3 51.13 L 84.24 45.1 L 76.83 47.51 L 73.36 52.79 L 70.28 55.18 L 136.82 54.18 L 136.82 61.48 L 128.05 61.48 L 133.2 57.14 L 124.71 57.14 L 119.26 61.48 L 111.62 61.48 L 116.78 57.14 L 108.29 57.14 L 102.83 61.48 L 93.82 61.48 L 99.14 57.24 L 90.36 57.24 L 84.78 61.48 L 74.95 61.48 L 80.53 57.14 L 71.94 57.14 L 66.9 61.48 L 66.9 64.32 L 136.82 64.32 L 136.82 112.04 L 200 112.04",
  
  //28ÌñâÎ≥µ
  "M 0 112 L 90.29 111.92 C 86.02 110.71 85.15 101.62 87.98 91.63 C 88.39 90.2 88.86 88.82 89.37 87.52 C 88.22 88.32 87 89.1 85.7 89.82 C 76.63 94.88 67.52 95.84 65.36 91.96 C 63.2 88.08 68.8 80.84 77.87 75.78 C 79.17 75.05 80.47 74.42 81.76 73.87 C 80.38 73.62 78.97 73.3 77.54 72.9 C 67.55 70.06 60.43 64.3 61.64 60.03 C 61.64 60.03 71.94 54.6 81.93 57.44 C 83.36 57.85 84.74 58.32 86.04 58.83 C 85.24 57.68 84.46 56.46 83.74 55.16 C 78.68 46.09 77.72 36.98 81.6 34.82 C 81.6 34.82 92.72 38.26 97.78 47.33 C 98.51 48.63 99.14 49.93 99.69 51.22 C 99.94 49.84 100.26 48.43 100.66 47 C 103.5 37.01 109.26 29.89 113.53 31.1 C 113.53 31.1 118.96 41.4 116.12 51.39 C 115.71 52.82 115.24 54.2 114.73 55.5 C 115.88 54.7 117.1 53.92 118.4 53.2 C 127.47 48.14 136.58 47.18 138.74 51.06 C 140.9 54.94 135.3 62.18 126.23 67.24 C 124.93 67.97 123.63 68.6 122.34 69.15 C 123.72 69.4 125.13 69.72 126.56 70.12 C 136.55 72.96 143.67 78.72 142.46 82.99 C 142.46 82.99 132.16 88.42 122.17 85.58 C 120.74 85.17 119.36 84.7 118.06 84.19 C 118.86 85.34 119.64 86.56 120.36 87.86 C 125.42 96.93 126.38 106.04 122.5 108.2 C 118.62 110.36 111.38 104.76 106.32 95.69 C 105.59 94.39 104.96 93.09 104.41 91.8 C 104.16 93.18 103.84 94.59 103.44 96.02 C 100.96 104.76 96.52 111.3 92.52 111.99 H 199.98",
  
  //29Í¥ÄÍ≥ÑÏª§ÌîåÏó∞Ïù∏ÏπúÍµ¨
  "M 200 112 H 144.03 C 144.03 98.29 138.42 86.52 130.39 81.38 C 135.09 78.39 138.21 73.15 138.21 67.17 C 138.21 57.86 130.66 50.32 121.36 50.32 C 121.36 50.32 104.51 57.87 104.51 67.17 C 104.51 73.15 107.63 78.39 112.33 81.38 C 106.61 85.04 102.12 92.07 100.01 100.78 C 97.9 92.08 93.41 85.05 87.69 81.38 C 92.39 78.39 95.51 73.15 95.51 67.17 C 95.51 57.86 87.96 50.32 78.66 50.32 C 78.66 50.32 61.81 57.87 61.81 67.17 C 61.81 73.15 64.93 78.39 69.63 81.38 C 61.6 86.52 55.99 98.29 55.99 112 H 0",
  
  //30Îßê
  "M 0 111.46 H 59.77 C 59.77 111.46 81.69 77.94 88.28 77.94 C 88.28 77.94 96.13 81.25 99.37 81.25 C 99.37 81.25 104.97 77.94 109.74 77.94 C 109.74 77.94 142.29 111.2 142.29 111.2 C 142.29 111.2 123.07 89.62 100.25 89.62 C 100.25 89.62 61.07 112.06 61.07 112.06 C 61.07 112.06 75.99 143.46 98.8 143.46 C 98.8 143.46 140.85 114.8 140.85 114.8 C 140.85 114.8 123.42 102.74 100.99 102.74 C 100.99 102.74 62.96 112.18 62.96 112.18 C 62.96 112.18 83.09 133.91 99.66 133.91 C 99.66 133.91 145.31 111.39 145.31 111.39 L 199.99 111.59",
  
  
  //""
  
  
];
// ÌååÏã±Îêú SVG Í≤∞Í≥º Ï†ÄÏû•Ïö©
let precomputedSVG = {};

function setup() {
  let canvasSize = min(windowWidth, windowHeight);
  cnv = createCanvas(canvasSize, canvasSize);

  centerCanvas();   // ‚≠ê Í∞ÄÎ°úÌòï ÌÉúÎ∏îÎ¶øÏóêÏÑúÎèÑ Ï∫îÎ≤ÑÏä§Í∞Ä Ï§ëÏïôÏóê Ïò§Í≤å

  centerY = height / 2;

  mic = new p5.AudioIn();
  mic.start();

  fft = new p5.FFT();
  fft.setInput(mic);

  preloadSVGs();

  setInterval(() => {
    let r = floor(random(svgPaths.length));
    mySVGPoints = precomputedSVG[r];
    triggerActive = true;
    triggerTime = millis();
  }, 5000);
}

function centerCanvas() {
  let x = (windowWidth - width) / 2;
  let y = (windowHeight - height) / 2;
  cnv.position(x, y);
}

function draw() {
  drawGradientBackground();

  waveformVals = getSmoothWaveform();
  if (!waveformVals) return;

  if (triggerActive && millis() - triggerTime < 3000 && mySVGPoints && mySVGPoints.length > 0) {
    drawSVGWaveform(waveformVals, mySVGPoints);
  } else {
    drawWaveform(waveformVals);
  }
}

// -------------------------
// üîß SVG Path ‚Üí Ï†ê Î∞∞Ïó¥ Î≥ÄÌôò
// -------------------------
function parseSVGPath(svgPath) {
  let raw = [];
  let currentX = 0, currentY = 0;

  // --- Path parsing ---
  let cmds = svgPath.match(/[a-zA-Z][^a-zA-Z]*/g);
  if (!cmds) return [];

  cmds.forEach(cmd => {
    let type = cmd[0];
    let nums = cmd.slice(1).trim().split(/[\s,]+/).map(Number);

    if (type === "M" || type === "L") {
      currentX = nums[0];
      currentY = nums[1];
      raw.push({x: currentX, y: currentY});
    } else if (type === "H") {
      currentX = nums[0];
      raw.push({x: currentX, y: currentY});
    } else if (type === "V") {
      currentY = nums[0];
      raw.push({x: currentX, y: currentY});
    } else if (type === "C") {
      for (let i = 0; i <= 50; i++) {
        let t = i / 50;
        let x = bezierPoint(currentX, nums[0], nums[2], nums[4], t);
        let y = bezierPoint(currentY, nums[1], nums[3], nums[5], t);
        raw.push({x, y});
      }
      currentX = nums[4];
      currentY = nums[5];
    }
  });

  if (raw.length < 2) return [];

  // --- Bounding box ---
  let minX = Math.min(...raw.map(p => p.x));
  let maxX = Math.max(...raw.map(p => p.x));
  let minY = Math.min(...raw.map(p => p.y));
  let maxY = Math.max(...raw.map(p => p.y));

  let bw = maxX - minX;
  if (bw === 0) bw = 1;

  // --- Í∞ÄÎ°ú Í∏∞Ï§Ä scale ---
  let scale = width / bw;

  // --- Î™®Îì† Ï†ê scale + translateX ---
  let scaled = raw.map(p => {
    return {
      x: (p.x - minX) * scale,
      y: (p.y - minY) * scale
    };
  });

  // --- üéØ ÌïµÏã¨: Ïñë ÎÅùÏ†ê y ÌèâÍ∑†ÏùÑ Ï§ëÏïôÏóê ÎßûÏ∂îÍ∏∞ ---
  let firstY = scaled[0].y;
  let lastY = scaled[scaled.length - 1].y;

  let pathMidY = (firstY + lastY) / 2;
  let canvasMidY = height / 2;

  let offsetY = canvasMidY - pathMidY;

  // --- ÏµúÏ¢Ö Î≥ÄÌôò ---
  let points = scaled.map(p => {
    return createVector(p.x, p.y + offsetY);
  });

  return points;
}


// Î™®Îì† pathÎ•º ÎØ∏Î¶¨ Ï†ê Î∞∞Ïó¥Î°ú Î≥ÄÌôò
function preloadSVGs() {
  for (let i = 0; i < svgPaths.length; i++) {
    precomputedSVG[i] = parseSVGPath(svgPaths[i]);
  }
}

// -------------------------
// üìà Í∏∞Î≥∏ waveform (ÏßÅÏÑ†Ìòï)
// -------------------------
function drawWaveform(waveform) {
  stroke(255);
  strokeWeight(5);
  noFill();
  beginShape();
  for (let i = 0; i < waveform.length; i++) {
    let x = map(i, 0, waveform.length, 0, width);
    let y = map(waveform[i], -1, 1, centerY + 50, centerY - 50);
    vertex(x, y);
  }
  endShape();
}

// -------------------------
// üåà ÏÑ∏Î°ú Í∑∏ÎùºÎç∞Ïù¥ÏÖò Î∞∞Í≤Ω
// -------------------------
function drawGradientBackground() {
  for (let y = 0; y < height; y++) {
    let t = y / height;

    let c3 = color('#E1306C'); // top (ÌïëÌÅ¨)
    let c4 = color('#C13584'); // middle (ÎßàÏ††ÌÉÄ)
    let c5 = color('#431A75'); // bottom (Î≥¥Îùº)

    let col;
    if (t < 0.5) {
      col = lerpColor(c3, c4, t / 0.5);
    } else {
      col = lerpColor(c4, c5, (t - 0.5) / 0.5);
    }

    stroke(col);
    line(0, y, width, y);
  }
}

// -------------------------
// üé≠ SVG ÌååÌòï Ïï†ÎãàÎ©îÏù¥ÏÖò
// -------------------------
function drawSVGWaveform(waveform, points) {
  stroke(255);
  strokeWeight(5);
  noFill();

  let avgAmp = waveform.reduce((acc, val) => acc + abs(val), 0) / waveform.length;
  let distortion = map(avgAmp, 0, 1, 20, 150);

  beginShape();
  for (let i = 0; i < points.length; i++) {
    let wIndex = floor(map(i, 0, points.length, 0, waveform.length));
    let amp = waveform[wIndex];
    let x = points[i].x + sin(i * 0.1 + frameCount * 0.05) * amp * distortion * 0.5;
    let y = points[i].y + cos(i * 0.1 + frameCount * 0.05) * amp * distortion;
    vertex(x, y);
  }
  endShape();
}

// -------------------------
// üîä waveform smoothing
// -------------------------
function getSmoothWaveform() {
  let waveform = fft.waveform();
  if (!waveform) return null;

  let smoothed = [];
  let buffer = 10;
  for (let i = 0; i < waveform.length; i++) {
    let sum = 0;
    let count = 0;
    for (let j = -buffer; j <= buffer; j++) {
      let idx = i + j;
      if (idx >= 0 && idx < waveform.length) {
        sum += waveform[idx];
        count++;
      }
    }
    smoothed.push(sum / count);
  }
  return smoothed;
}

// Ï∞Ω ÌÅ¨Í∏∞ Î∞îÎÄåÎ©¥ Ï†ïÎ∞©Ìòï Ïú†ÏßÄ
function windowResized() {
  let canvasSize = min(windowWidth, windowHeight);
  resizeCanvas(canvasSize, canvasSize);

  centerY = height / 2;

  preloadSVGs();
  centerCanvas();   // ‚≠ê Î∞òÎìúÏãú ÌïÑÏöî!
}
